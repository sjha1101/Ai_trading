<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/homepage.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
</head>

<body>
    <!-- Stocks Section -->
    <section id="stocks">
        <h2 class="text-center text-success fs-4 mb-5"><span class="headingColor">STOCKS</span></h2>
        <div class="container">
            <div class="card shadow-sm p-3">
                <p class="mt-3 reference">
                    Track live stock prices, market trends, and get AI-based stock suggestions tailored to your
                    portfolio preferences.
                </p>

                <!-- Chart -->
                <div class="chart-container mx-auto my-4" style="max-width: 700px;">
                    <canvas id="stockChart"></canvas>
                </div>

                <!-- Table -->
                <div class="table-responsive mt-4">
                    <table class="table table-bordered table-hover text-center">
                        <thead class="thead-dark">
                            <tr>
                                <th>Symbol</th>
                                <th>Company</th>
                                <th>Price</th>
                                <th>Change</th>
                                <th>AI Suggestion</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for stock in stocks %}
                            <tr>
                                <!-- Logo -->
                                <td>
                                    <img src="{{ url_for('static', filename=stock.symbol_image) }}"
                                        alt="{{ stock.company }}" width="40" height="40">
                                </td>

                                <!-- Company Name -->
                                <td>{{ stock.company }}</td>

                                <!-- Price -->
                                <td>₹{{ stock.price }}</td>

                                <!-- Change -->
                                <td
                                    class="{{ 'text-success' if stock.change_value.startswith('+') else 'text-danger' }}">
                                    {{ stock.change_value }}
                                </td>

                                <!-- Suggestion Badge -->
                                <td>
                                    <span class="badge 
                                        {% if stock.suggestion == 'Buy' %}
                                            badge-success
                                        {% elif stock.suggestion == 'Hold' %}
                                            badge-warning
                                        {% else %}
                                            badge-danger
                                        {% endif %}
                                    ">
                                        {{ stock.suggestion }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </section>


    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let stockData = [
            { company: 'Company A', price: 100 },
            { company: 'Company B', price: 200 },
            { company: 'Company C', price: 300 }
        ];

        let stockLabels = stockData.map(stock => stock.company);
        let stockPrices = stockData.map(stock => stock.price);

        const ctx = document.getElementById('stockChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: stockLabels,
                datasets: [{
                    label: 'Stock Prices (₹)',
                    data: stockPrices,
                    backgroundColor: 'rgba(0, 123, 255, 0.6)',
                    borderColor: 'rgba(0, 123, 255, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });
    </script>

</body>

</html>